<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ§ªğŸ”¬ NaWi-Quiz â€“ Physik & Chemie</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap');

  :root {
    --primary: #6C63FF;
    --primary-dark: #5A52D5;
    --accent: #FF6584;
    --success: #2ECC71;
    --error: #E74C3C;
    --warning: #F39C12;
    --bg: #0f0c29;
    --bg2: #302b63;
    --bg3: #24243e;
    --card: rgba(255,255,255,0.07);
    --card-hover: rgba(255,255,255,0.12);
    --text: #f0f0f0;
    --text-dim: #a0a0b0;
    --gold: #FFD700;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, var(--bg), var(--bg2), var(--bg3));
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* â”€â”€â”€ Particles Background â”€â”€â”€ */
  #particles {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 0;
  }
  .particle {
    position: absolute;
    border-radius: 50%;
    animation: float linear infinite;
    opacity: 0.3;
  }
  @keyframes float {
    0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
    10% { opacity: 0.3; }
    90% { opacity: 0.3; }
    100% { transform: translateY(-10vh) rotate(720deg); opacity: 0; }
  }

  /* â”€â”€â”€ Layout â”€â”€â”€ */
  .container {
    position: relative; z-index: 1;
    max-width: 900px; margin: 0 auto; padding: 20px;
  }

  /* â”€â”€â”€ Start Screen â”€â”€â”€ */
  #startScreen {
    display: flex; flex-direction: column; align-items: center;
    justify-content: center; min-height: 100vh; text-align: center;
    animation: fadeIn 1s;
  }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

  #startScreen h1 {
    font-size: 3em; font-weight: 800;
    background: linear-gradient(135deg, var(--primary), var(--accent), var(--gold));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 10px;
    animation: glow 3s ease-in-out infinite alternate;
  }
  @keyframes glow {
    from { filter: drop-shadow(0 0 8px rgba(108,99,255,0.5)); }
    to { filter: drop-shadow(0 0 20px rgba(255,101,132,0.8)); }
  }
  #startScreen .subtitle { font-size: 1.2em; color: var(--text-dim); margin-bottom: 30px; }
  
  .topic-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 12px; width: 100%; max-width: 700px; margin-bottom: 30px;
  }
  .topic-card {
    background: var(--card); border-radius: 14px; padding: 16px;
    border: 1px solid rgba(255,255,255,0.1);
    transition: all 0.3s;
  }
  .topic-card:hover { background: var(--card-hover); transform: translateY(-2px); }
  .topic-card .icon { font-size: 2em; margin-bottom: 6px; }
  .topic-card .label { font-size: 0.85em; font-weight: 600; }
  .topic-card .desc { font-size: 0.7em; color: var(--text-dim); margin-top: 4px; }

  .btn {
    padding: 14px 40px; border: none; border-radius: 50px;
    font-family: inherit; font-size: 1.1em; font-weight: 700;
    cursor: pointer; transition: all 0.3s;
    text-transform: uppercase; letter-spacing: 1px;
  }
  .btn-primary {
    background: linear-gradient(135deg, var(--primary), var(--accent));
    color: #fff;
    box-shadow: 0 4px 20px rgba(108,99,255,0.4);
  }
  .btn-primary:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 8px 30px rgba(108,99,255,0.6);
  }
  .btn-sm {
    padding: 10px 24px; font-size: 0.9em;
  }
  .btn-success { background: var(--success); color: #fff; }
  .btn-outline {
    background: transparent; border: 2px solid var(--primary); color: var(--primary);
  }

  /* â”€â”€â”€ Progress Bar â”€â”€â”€ */
  #progressArea {
    position: sticky; top: 0; z-index: 100;
    background: rgba(15,12,41,0.95); backdrop-filter: blur(10px);
    padding: 12px 20px; border-bottom: 1px solid rgba(255,255,255,0.1);
    display: none;
  }
  .progress-info {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 6px; font-size: 0.85em;
  }
  .progress-bar-bg {
    width: 100%; height: 8px; background: rgba(255,255,255,0.1);
    border-radius: 10px; overflow: hidden;
  }
  .progress-bar-fill {
    height: 100%; border-radius: 10px;
    background: linear-gradient(90deg, var(--primary), var(--accent));
    transition: width 0.5s ease;
    width: 0%;
  }
  .score-badge {
    background: linear-gradient(135deg, var(--gold), #FFA500);
    color: #000; padding: 4px 14px; border-radius: 20px;
    font-weight: 700; font-size: 0.85em;
  }

  /* â”€â”€â”€ Question Cards â”€â”€â”€ */
  .question-section {
    display: none;
    animation: slideIn 0.5s ease;
  }
  .question-section.active { display: block; }
  @keyframes slideIn { from { opacity: 0; transform: translateX(50px); } to { opacity: 1; transform: translateX(0); } }

  .section-header {
    text-align: center; margin: 30px 0 20px;
  }
  .section-header .section-icon { font-size: 3em; margin-bottom: 8px; }
  .section-header h2 {
    font-size: 1.8em; font-weight: 700;
    background: linear-gradient(90deg, var(--primary), var(--accent));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  .section-header .section-sub { font-size: 0.9em; color: var(--text-dim); }

  .q-card {
    background: var(--card); border-radius: 20px; padding: 28px;
    margin-bottom: 24px;
    border: 1px solid rgba(255,255,255,0.08);
    transition: all 0.3s;
  }
  .q-card:hover { border-color: rgba(108,99,255,0.3); }
  .q-card.correct { border-color: var(--success) !important; box-shadow: 0 0 20px rgba(46,204,113,0.2); }
  .q-card.wrong { border-color: var(--error) !important; box-shadow: 0 0 20px rgba(231,76,60,0.2); }

  .q-number {
    display: inline-block; background: linear-gradient(135deg, var(--primary), var(--accent));
    color: #fff; width: 32px; height: 32px; border-radius: 50%;
    text-align: center; line-height: 32px; font-weight: 700; font-size: 0.85em;
    margin-right: 10px;
  }
  .q-points {
    float: right; background: rgba(255,215,0,0.15); color: var(--gold);
    padding: 4px 12px; border-radius: 12px; font-size: 0.8em; font-weight: 600;
  }
  .q-title {
    font-size: 1.05em; font-weight: 600; margin-bottom: 16px; line-height: 1.5;
  }
  .q-hint {
    background: rgba(243,156,18,0.1); border-left: 3px solid var(--warning);
    padding: 10px 16px; border-radius: 0 10px 10px 0; margin: 12px 0;
    font-size: 0.85em; color: var(--warning);
  }

  /* â”€â”€â”€ MC Options â”€â”€â”€ */
  .mc-options { display: flex; flex-direction: column; gap: 10px; }
  .mc-option {
    background: rgba(255,255,255,0.05); border: 2px solid rgba(255,255,255,0.1);
    border-radius: 12px; padding: 14px 18px; cursor: pointer;
    transition: all 0.3s; font-size: 0.95em;
    display: flex; align-items: center; gap: 12px;
  }
  .mc-option:hover { background: rgba(108,99,255,0.15); border-color: var(--primary); }
  .mc-option.selected { background: rgba(108,99,255,0.2); border-color: var(--primary); }
  .mc-option.correct-answer { background: rgba(46,204,113,0.2) !important; border-color: var(--success) !important; }
  .mc-option.wrong-answer { background: rgba(231,76,60,0.2) !important; border-color: var(--error) !important; }
  .mc-option .letter {
    width: 28px; height: 28px; border-radius: 50%;
    background: rgba(255,255,255,0.1); text-align: center; line-height: 28px;
    font-weight: 700; font-size: 0.85em; flex-shrink: 0;
  }

  /* â”€â”€â”€ Multi-select (Checkboxes) â”€â”€â”€ */
  .mc-option.multi .letter { border-radius: 6px; }

  /* â”€â”€â”€ Input Fields â”€â”€â”€ */
  .input-row {
    display: flex; gap: 12px; align-items: center; margin: 8px 0;
    flex-wrap: wrap;
  }
  .input-row label { font-size: 0.9em; min-width: 120px; }
  .q-input {
    background: rgba(255,255,255,0.08); border: 2px solid rgba(255,255,255,0.15);
    border-radius: 10px; padding: 10px 16px; color: var(--text);
    font-family: inherit; font-size: 0.95em; width: auto; min-width: 100px;
    transition: all 0.3s; outline: none;
  }
  .q-input:focus { border-color: var(--primary); background: rgba(108,99,255,0.1); }
  .q-input.correct-input { border-color: var(--success) !important; background: rgba(46,204,113,0.1) !important; }
  .q-input.wrong-input { border-color: var(--error) !important; background: rgba(231,76,60,0.1) !important; }
  .q-input-wide { width: 100%; }

  /* â”€â”€â”€ Tables â”€â”€â”€ */
  .q-table {
    width: 100%; border-collapse: separate; border-spacing: 0;
    margin: 14px 0; border-radius: 12px; overflow: hidden;
    font-size: 0.9em;
  }
  .q-table th {
    background: rgba(108,99,255,0.2); padding: 12px 14px;
    text-align: left; font-weight: 600;
  }
  .q-table td {
    padding: 10px 14px; border-top: 1px solid rgba(255,255,255,0.05);
    background: rgba(255,255,255,0.02);
  }
  .q-table tr:hover td { background: rgba(255,255,255,0.05); }

  /* â”€â”€â”€ Drawing Canvas â”€â”€â”€ */
  .canvas-container {
    position: relative; margin: 16px 0;
    background: #1a1a2e; border-radius: 14px; overflow: hidden;
    border: 2px solid rgba(255,255,255,0.1);
  }
  .canvas-container canvas {
    display: block; width: 100%; cursor: crosshair;
  }
  .canvas-tools {
    display: flex; gap: 8px; padding: 10px 14px;
    background: rgba(0,0,0,0.3); flex-wrap: wrap; align-items: center;
  }
  .canvas-tools .btn-tool {
    padding: 6px 14px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);
    background: rgba(255,255,255,0.08); color: var(--text); cursor: pointer;
    font-family: inherit; font-size: 0.8em; transition: all 0.2s;
  }
  .canvas-tools .btn-tool:hover { background: rgba(108,99,255,0.3); }
  .canvas-tools .btn-tool.active { background: var(--primary); border-color: var(--primary); }
  .color-pick {
    width: 28px; height: 28px; border-radius: 50%; border: 2px solid #fff;
    cursor: pointer; transition: transform 0.2s;
  }
  .color-pick:hover { transform: scale(1.2); }

  /* â”€â”€â”€ Drag & Drop â”€â”€â”€ */
  .drag-container {
    display: flex; flex-wrap: wrap; gap: 10px; margin: 14px 0;
    min-height: 50px; justify-content: center;
  }
  .drag-item {
    background: linear-gradient(135deg, rgba(108,99,255,0.3), rgba(255,101,132,0.3));
    border: 2px solid rgba(108,99,255,0.5); border-radius: 10px;
    padding: 8px 16px; cursor: grab; font-size: 0.9em; font-weight: 600;
    transition: all 0.2s; user-select: none;
  }
  .drag-item:hover { transform: scale(1.05); }
  .drag-item.dragging { opacity: 0.5; transform: scale(0.95); }

  .drop-zone {
    min-height: 44px; border: 2px dashed rgba(255,255,255,0.2);
    border-radius: 10px; padding: 8px; display: flex; align-items: center;
    justify-content: center; transition: all 0.3s; min-width: 120px;
    font-size: 0.85em; color: var(--text-dim);
  }
  .drop-zone.over { border-color: var(--primary); background: rgba(108,99,255,0.1); }
  .drop-zone.filled { border-style: solid; border-color: var(--primary); }
  .drop-zone .drag-item { margin: 0; }

  /* â”€â”€â”€ Matching â”€â”€â”€ */
  .match-grid {
    display: grid; grid-template-columns: 1fr auto 1fr;
    gap: 10px; align-items: center; margin: 14px 0;
  }
  .match-left, .match-right {
    background: rgba(255,255,255,0.05); border-radius: 10px; padding: 12px 16px;
    font-size: 0.9em;
  }
  .match-arrow { color: var(--text-dim); font-size: 1.2em; }

  /* â”€â”€â”€ Feedback â”€â”€â”€ */
  .feedback {
    margin-top: 14px; padding: 12px 18px; border-radius: 12px;
    font-size: 0.9em; display: none;
    animation: fadeIn 0.3s;
  }
  .feedback.show { display: block; }
  .feedback.correct-fb {
    background: rgba(46,204,113,0.15); border: 1px solid var(--success); color: #7dffb3;
  }
  .feedback.wrong-fb {
    background: rgba(231,76,60,0.15); border: 1px solid var(--error); color: #ff9a8b;
  }

  /* â”€â”€â”€ Section Check Button â”€â”€â”€ */
  .section-check {
    text-align: center; margin: 30px 0;
  }

  /* â”€â”€â”€ Navigation â”€â”€â”€ */
  .nav-buttons {
    display: flex; justify-content: space-between; margin: 30px 0;
    gap: 12px;
  }

  /* â”€â”€â”€ Result Screen â”€â”€â”€ */
  #resultScreen {
    display: none; text-align: center; padding: 60px 20px;
    animation: fadeIn 0.8s;
  }
  .result-circle {
    width: 200px; height: 200px; border-radius: 50%;
    margin: 0 auto 30px;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    font-size: 3em; font-weight: 800;
    background: conic-gradient(var(--success) var(--score-pct), rgba(255,255,255,0.1) var(--score-pct));
    position: relative;
  }
  .result-circle-inner {
    width: 170px; height: 170px; border-radius: 50%;
    background: var(--bg2);
    display: flex; flex-direction: column; align-items: center; justify-content: center;
  }
  .result-circle-inner .pct { font-size: 2.5em; font-weight: 800; }
  .result-circle-inner .pct-label { font-size: 0.5em; color: var(--text-dim); }

  .result-grade {
    font-size: 2em; font-weight: 700; margin: 16px 0 8px;
  }
  .result-msg { color: var(--text-dim); margin-bottom: 30px; }

  .result-breakdown {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 14px; max-width: 700px; margin: 0 auto 30px;
  }
  .result-cat {
    background: var(--card); border-radius: 14px; padding: 16px;
    border: 1px solid rgba(255,255,255,0.08);
  }
  .result-cat .cat-icon { font-size: 1.5em; }
  .result-cat .cat-name { font-size: 0.8em; color: var(--text-dim); margin: 6px 0; }
  .result-cat .cat-score { font-size: 1.3em; font-weight: 700; }
  .result-cat .cat-bar {
    height: 4px; background: rgba(255,255,255,0.1); border-radius: 4px;
    margin-top: 8px; overflow: hidden;
  }
  .result-cat .cat-bar-fill {
    height: 100%; border-radius: 4px;
    background: linear-gradient(90deg, var(--primary), var(--accent));
    transition: width 1s ease;
  }

  /* â”€â”€â”€ Confetti â”€â”€â”€ */
  .confetti-piece {
    position: fixed; z-index: 9999;
    width: 10px; height: 10px;
    animation: confettiFall linear forwards;
  }
  @keyframes confettiFall {
    0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
    100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
  }

  /* â”€â”€â”€ Equation display â”€â”€â”€ */
  .equation-box {
    background: rgba(0,0,0,0.3); border-radius: 12px; padding: 16px 20px;
    margin: 12px 0; font-size: 1.1em; text-align: center;
    border: 1px solid rgba(108,99,255,0.2);
    font-family: 'Courier New', monospace;
    letter-spacing: 1px;
  }

  /* â”€â”€â”€ Inline sub/superscript â”€â”€â”€ */
  .chem sub { font-size: 0.75em; }
  .chem sup { font-size: 0.75em; }

  /* â”€â”€â”€ Responsive â”€â”€â”€ */
  @media (max-width: 600px) {
    #startScreen h1 { font-size: 2em; }
    .q-card { padding: 18px; }
    .topic-grid { grid-template-columns: 1fr 1fr; }
    .result-breakdown { grid-template-columns: 1fr 1fr; }
  }

  /* â”€â”€â”€ Tooltip â”€â”€â”€ */
  .tooltip-container { position: relative; display: inline-block; }
  .tooltip-container .tooltip-text {
    visibility: hidden; opacity: 0;
    background: rgba(0,0,0,0.9); color: #fff; padding: 8px 12px;
    border-radius: 8px; font-size: 0.8em; position: absolute;
    bottom: 120%; left: 50%; transform: translateX(-50%);
    white-space: nowrap; transition: all 0.3s; z-index: 10;
  }
  .tooltip-container:hover .tooltip-text { visibility: visible; opacity: 1; }

  /* â”€â”€â”€ Schematic inside canvas â”€â”€â”€ */
  .schema-label {
    font-size: 0.8em; color: var(--text-dim); text-align: center; margin-top: 6px;
  }

  /* â”€â”€â”€ Toggle (for multi-part) â”€â”€â”€ */
  .part-label {
    display: inline-block; background: rgba(108,99,255,0.2);
    padding: 4px 12px; border-radius: 8px; font-size: 0.8em;
    font-weight: 600; color: var(--primary); margin-bottom: 10px;
  }

  /* â”€â”€â”€ Separator â”€â”€â”€ */
  .sep {
    border: none; border-top: 1px solid rgba(255,255,255,0.08);
    margin: 20px 0;
  }

  /* â”€â”€â”€ Textarea â”€â”€â”€ */
  .q-textarea {
    background: rgba(255,255,255,0.08); border: 2px solid rgba(255,255,255,0.15);
    border-radius: 10px; padding: 12px 16px; color: var(--text);
    font-family: inherit; font-size: 0.9em; width: 100%; min-height: 80px;
    resize: vertical; outline: none; transition: all 0.3s;
  }
  .q-textarea:focus { border-color: var(--primary); }

  .inline-input {
    display: inline-block; width: 60px; text-align: center;
    background: rgba(255,255,255,0.08); border: 2px solid rgba(255,255,255,0.15);
    border-radius: 8px; padding: 4px 8px; color: var(--text);
    font-family: inherit; font-size: 0.95em; outline: none;
    transition: all 0.3s;
  }
  .inline-input:focus { border-color: var(--primary); }

  .formula-display {
    font-family: 'Courier New', monospace;
    font-size: 1.15em;
    letter-spacing: 1px;
  }

  /* â”€â”€â”€ Animated entry for sections â”€â”€â”€ */
  @keyframes bounceIn {
    0% { transform: scale(0.3); opacity: 0; }
    50% { transform: scale(1.05); }
    70% { transform: scale(0.95); }
    100% { transform: scale(1); opacity: 1; }
  }
  .bounce-in { animation: bounceIn 0.6s ease; }
</style>
</head>
<body>

<!-- Particles Background -->
<div id="particles"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• START SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="startScreen" class="container">
  <h1>ğŸ§ª NaWi-Quiz</h1>
  <p class="subtitle">Physik & Chemie â€“ Interaktive Klausur</p>

  <div class="topic-grid">
    <div class="topic-card">
      <div class="icon">ğŸ”¦</div>
      <div class="label">Optik</div>
      <div class="desc">Reflexion, Brechung, Schatten, Spiegel</div>
    </div>
    <div class="topic-card">
      <div class="icon">âš¡</div>
      <div class="label">E-Lehre</div>
      <div class="desc">Ohm, Schaltungen, Leistung</div>
    </div>
    <div class="topic-card">
      <div class="icon">ğŸ§²</div>
      <div class="label">Magnetismus</div>
      <div class="desc">Elementarmagnete, Ferromagnetismus</div>
    </div>
    <div class="topic-card">
      <div class="icon">âš—ï¸</div>
      <div class="label">Chemie</div>
      <div class="desc">Redox, SÃ¤ure-Base, Organik</div>
    </div>
    <div class="topic-card">
      <div class="icon">ğŸŒ±</div>
      <div class="label">Nachhaltigkeit</div>
      <div class="desc">Kunststoffe, GrÃ¼ne Chemie</div>
    </div>
    <div class="topic-card">
      <div class="icon">ğŸ†</div>
      <div class="label">70 Punkte</div>
      <div class="desc">~30 Min Bearbeitungszeit</div>
    </div>
  </div>

  <button class="btn btn-primary" onclick="startQuiz()">Quiz starten ğŸš€</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PROGRESS BAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="progressArea">
  <div class="progress-info">
    <span id="progressLabel">Teil A: Optik</span>
    <span class="score-badge" id="scoreBadge">â­ 0 / 70</span>
  </div>
  <div class="progress-bar-bg">
    <div class="progress-bar-fill" id="progressFill"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• QUIZ SECTIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="container" id="quizContainer" style="display:none;">

<!-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
     â•‘        TEIL A: OPTIK (14 Punkte)          â•‘
     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="question-section active" id="sectionA">
  <div class="section-header bounce-in">
    <div class="section-icon">ğŸ”¦</div>
    <h2>Teil A: Optik</h2>
    <div class="section-sub">VerstÃ¤ndnis & Zeichnung Â· 14 Punkte</div>
  </div>

  <!-- Q1: VerstÃ¤ndnisfrage Optik (mehrere Teile) â€“ 7P -->
  <div class="q-card" id="q1">
    <span class="q-points">7 Punkte</span>
    <p class="q-title"><span class="q-number">1</span> Licht & seine Eigenschaften</p>

    <div class="part-label">Teil a) â€“ 2 Punkte</div>
    <p style="margin-bottom:12px;">Ein Lichtstrahl geht von <strong>Luft (n = 1,0)</strong> in <strong>Wasser (n = 1,33)</strong> Ã¼ber. Der Einfallswinkel betrÃ¤gt Î± = 30Â°.</p>
    <p style="margin-bottom:8px;">In welche Richtung wird der Strahl gebrochen?</p>
    <div class="mc-options" data-qid="q1a" data-correct="0">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Zum Lot hin â€“ von optisch dÃ¼nnerem zu optisch dichterem Medium
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Vom Lot weg â€“ von optisch dÃ¼nnerem zu optisch dichterem Medium
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> Zum Lot hin â€“ von optisch dichterem zu optisch dÃ¼nnerem Medium
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">D</span> Der Strahl wird gar nicht gebrochen
      </div>
    </div>
    <div class="feedback" id="fb-q1a"></div>

    <hr class="sep">

    <div class="part-label">Teil b) â€“ 2 Punkte</div>
    <p style="margin-bottom:8px;">Was ist <strong>Totalreflexion</strong>? Unter welcher Bedingung tritt sie auf?</p>
    <div class="mc-options" data-qid="q1b" data-correct="1">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Licht wird beim Ãœbergang von optisch dÃ¼nnerem zu dichterem Medium vollstÃ¤ndig reflektiert
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Licht wird beim Ãœbergang von optisch dichterem zu dÃ¼nnerem Medium vollstÃ¤ndig reflektiert, wenn der Einfallswinkel grÃ¶ÃŸer als der Grenzwinkel ist
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> Licht wird an einer verspiegelten OberflÃ¤che komplett zurÃ¼ckgeworfen
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">D</span> Licht wird beim Auftreffen auf eine schwarze FlÃ¤che absorbiert
      </div>
    </div>
    <div class="feedback" id="fb-q1b"></div>

    <hr class="sep">

    <div class="part-label">Teil c) â€“ 1 Punkt</div>
    <p style="margin-bottom:8px;">Nennen Sie eine technische Anwendung der Totalreflexion:</p>
    <div class="mc-options" data-qid="q1c" data-correct="2">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Brille
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Spiegel
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> Glasfaserkabel (Lichtleiter)
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">D</span> Taschenlampe
      </div>
    </div>
    <div class="feedback" id="fb-q1c"></div>

    <hr class="sep">

    <div class="part-label">Teil d) â€“ 2 Punkte</div>
    <p style="margin-bottom:8px;">Ein Spiegel vertauscht <strong>nicht</strong> links und rechts. Was vertauscht er tatsÃ¤chlich? Und: Wie groÃŸ muss ein Spiegel mindestens sein, damit sich eine 180 cm groÃŸe Person vollstÃ¤ndig sehen kann?</p>
    <div class="input-row">
      <label>Vertauscht wird:</label>
      <select class="q-input" id="q1d-swap" style="min-width:180px;">
        <option value="">â€“ auswÃ¤hlen â€“</option>
        <option value="vorne-hinten">Vorne und hinten</option>
        <option value="oben-unten">Oben und unten</option>
        <option value="links-rechts">Links und rechts</option>
      </select>
    </div>
    <div class="input-row" style="margin-top:8px;">
      <label>Min. SpiegelgrÃ¶ÃŸe:</label>
      <input type="text" class="q-input" id="q1d-size" placeholder="? cm" style="width:100px;">
    </div>
    <div class="feedback" id="fb-q1d"></div>
  </div>

  <!-- Q2: Zeichnungsaufgabe â€“ Reflexion am Spiegel & Schatten (7P) -->
  <div class="q-card" id="q2">
    <span class="q-points">7 Punkte</span>
    <p class="q-title"><span class="q-number">2</span> Zeichenaufgabe: Reflexion & Schatten</p>

    <div class="part-label">Teil a) â€“ Reflexion am Spiegel â€“ 4 Punkte</div>
    <p style="margin-bottom:8px;">Zeichnen Sie den reflektierten Lichtstrahl am ebenen Spiegel. Beachten Sie: <strong>Einfallswinkel = Ausfallswinkel</strong> (gemessen vom Lot).</p>
    <p class="q-hint">ğŸ’¡ Nutzen Sie die Zeichenwerkzeuge. Gelb = einfallender Strahl (vorgegeben), GrÃ¼n = Ihr reflektierter Strahl. Das Lot ist gestrichelt eingezeichnet.</p>
    <div class="canvas-container">
      <canvas id="mirrorCanvas" width="800" height="400"></canvas>
      <div class="canvas-tools">
        <button class="btn-tool active" onclick="setDrawColor('#2ECC71', this)" style="color:#2ECC71">âœï¸ GrÃ¼n (Reflexion)</button>
        <button class="btn-tool" onclick="setDrawColor('#E74C3C', this)" style="color:#E74C3C">âœï¸ Rot</button>
        <button class="btn-tool" onclick="setDrawColor('#3498DB', this)" style="color:#3498DB">âœï¸ Blau</button>
        <button class="btn-tool" onclick="clearCanvas('mirrorCanvas')">ğŸ—‘ï¸ LÃ¶schen</button>
        <button class="btn-tool" onclick="undoCanvas('mirrorCanvas')">â†©ï¸ RÃ¼ckgÃ¤ngig</button>
      </div>
    </div>

    <hr class="sep">

    <div class="part-label">Teil b) â€“ Schattenbildung â€“ 3 Punkte</div>
    <p style="margin-bottom:8px;">Eine <strong>Punktlichtquelle</strong> (â˜€ï¸) beleuchtet einen Gegenstand. Zeichnen Sie die <strong>Randstrahlen</strong> und den <strong>Schatten</strong> auf der Wand ein.</p>
    <div class="canvas-container">
      <canvas id="shadowCanvas" width="800" height="400"></canvas>
      <div class="canvas-tools">
        <button class="btn-tool active" onclick="setDrawColor2('#FFD700', this)" style="color:#FFD700">âœï¸ Gelb (Strahlen)</button>
        <button class="btn-tool" onclick="setDrawColor2('#888', this)" style="color:#888">âœï¸ Grau (Schatten)</button>
        <button class="btn-tool" onclick="setDrawColor2('#E74C3C', this)" style="color:#E74C3C">âœï¸ Rot</button>
        <button class="btn-tool" onclick="clearCanvas('shadowCanvas')">ğŸ—‘ï¸ LÃ¶schen</button>
        <button class="btn-tool" onclick="undoCanvas('shadowCanvas')">â†©ï¸ RÃ¼ckgÃ¤ngig</button>
      </div>
    </div>
    <p class="schema-label">Punktlichtquelle links Â· Gegenstand Mitte Â· Wand rechts</p>
  </div>

  <div class="nav-buttons">
    <div></div>
    <button class="btn btn-primary btn-sm" onclick="goToSection(1)">Weiter: E-Lehre âš¡ â†’</button>
  </div>
</div>

<!-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
     â•‘      TEIL B: ELEKTRIZITÃ„TSLEHRE (12P)     â•‘
     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="question-section" id="sectionB">
  <div class="section-header bounce-in">
    <div class="section-icon">âš¡</div>
    <h2>Teil B: ElektrizitÃ¤tslehre</h2>
    <div class="section-sub">Rechenaufgabe & VerstÃ¤ndnis Â· 12 Punkte</div>
  </div>

  <!-- Q3: Rechenaufgabe E-Lehre (7P) -->
  <div class="q-card" id="q3">
    <span class="q-points">7 Punkte</span>
    <p class="q-title"><span class="q-number">3</span> Stromkreis-Berechnung</p>
    <p style="margin-bottom:14px;">Zwei WiderstÃ¤nde <strong>Râ‚ = 20 Î©</strong> und <strong>Râ‚‚ = 30 Î©</strong> sind <strong>in Reihe</strong> an eine Batterie mit <strong>U = 10 V</strong> angeschlossen.</p>

    <div class="part-label">a) Gesamtwiderstand (1P)</div>
    <div class="input-row">
      <label>R<sub>ges</sub> = </label>
      <input type="text" class="q-input" id="q3a" placeholder="? Î©" style="width:100px;">
      <span class="q-hint" style="margin:0; padding: 4px 10px;">Tipp: R<sub>ges</sub> = Râ‚ + Râ‚‚</span>
    </div>

    <div class="part-label" style="margin-top:14px;">b) StromstÃ¤rke (2P)</div>
    <div class="input-row">
      <label>I = </label>
      <input type="text" class="q-input" id="q3b" placeholder="? A" style="width:100px;">
      <span class="q-hint" style="margin:0; padding: 4px 10px;">Tipp: I = U / R</span>
    </div>

    <div class="part-label" style="margin-top:14px;">c) Teilspannungen (2P)</div>
    <div class="input-row">
      <label>Uâ‚ (an Râ‚) = </label>
      <input type="text" class="q-input" id="q3c1" placeholder="? V" style="width:100px;">
    </div>
    <div class="input-row">
      <label>Uâ‚‚ (an Râ‚‚) = </label>
      <input type="text" class="q-input" id="q3c2" placeholder="? V" style="width:100px;">
    </div>

    <div class="part-label" style="margin-top:14px;">d) Leistung & Energie (2P)</div>
    <p style="margin-bottom:8px; font-size:0.9em;">Ein GerÃ¤t wird mit <strong>P = 2000 W</strong> an <strong>230 V</strong> betrieben. Berechnen Sie die StromstÃ¤rke und ob man zwei solche GerÃ¤te an einer <strong>16 A Sicherung</strong> betreiben kann.</p>
    <div class="input-row">
      <label>I pro GerÃ¤t â‰ˆ</label>
      <input type="text" class="q-input" id="q3d1" placeholder="? A" style="width:100px;">
    </div>
    <div class="input-row">
      <label>2 GerÃ¤te mÃ¶glich?</label>
      <select class="q-input" id="q3d2" style="min-width:120px;">
        <option value="">â€“ wÃ¤hlen â€“</option>
        <option value="nein">Nein</option>
        <option value="ja">Ja</option>
      </select>
    </div>
    <div class="feedback" id="fb-q3"></div>
  </div>

  <!-- Q4: VerstÃ¤ndnisaufgabe E-Lehre (5P) -->
  <div class="q-card" id="q4">
    <span class="q-points">5 Punkte</span>
    <p class="q-title"><span class="q-number">4</span> VerstÃ¤ndnis: ElektrizitÃ¤t</p>

    <div class="part-label">a) SchÃ¼lervorstellung (2P)</div>
    <p style="margin-bottom:8px;">Ein SchÃ¼ler sagt: â€Der Strom wird in der GlÃ¼hbirne verbraucht." Was ist daran falsch?</p>
    <div class="mc-options" data-qid="q4a" data-correct="1">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Die Aussage stimmt â€“ Strom wird tatsÃ¤chlich verbraucht
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Die StromstÃ¤rke ist in der Reihenschaltung Ã¼berall gleich. Es wird elektrische <em>Energie</em> umgewandelt, nicht Strom verbraucht
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> Der Strom wird nur teilweise verbraucht â€“ die HÃ¤lfte kommt zurÃ¼ck
      </div>
    </div>
    <div class="feedback" id="fb-q4a"></div>

    <hr class="sep">

    <div class="part-label">b) MessgerÃ¤te (1P)</div>
    <p style="margin-bottom:8px;">Wo wird ein Amperemeter eingebaut?</p>
    <div class="mc-options" data-qid="q4b" data-correct="0">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> In Reihe (zum Verbraucher)
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Parallel (zum Verbraucher)
      </div>
    </div>
    <div class="feedback" id="fb-q4b"></div>

    <hr class="sep">

    <div class="part-label">c) Reihen- vs. Parallelschaltung (2P)</div>
    <p style="margin-bottom:8px;">In einer Lichterkette mit 46 LÃ¤mpchen in Reihe an 230 V: Wie viel Volt liegen an jedem LÃ¤mpchen an?</p>
    <div class="input-row">
      <label>U pro LÃ¤mpchen = </label>
      <input type="text" class="q-input" id="q4c" placeholder="? V" style="width:100px;">
    </div>
    <p style="margin-top:8px; margin-bottom:8px; font-size:0.9em;">Jedes LÃ¤mpchen vertrÃ¤gt max. 6 V. Wie viele LÃ¤mpchen braucht man <strong>mindestens</strong>?</p>
    <div class="input-row">
      <label>Mindestens:</label>
      <input type="text" class="q-input" id="q4c2" placeholder="?" style="width:80px;"> LÃ¤mpchen
    </div>
    <div class="feedback" id="fb-q4c"></div>
  </div>

  <div class="nav-buttons">
    <button class="btn btn-outline btn-sm" onclick="goToSection(0)">â† Optik</button>
    <button class="btn btn-primary btn-sm" onclick="goToSection(2)">Weiter: Magnetismus ğŸ§² â†’</button>
  </div>
</div>

<!-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
     â•‘      TEIL C: MAGNETISMUS (8 Punkte)       â•‘
     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="question-section" id="sectionC">
  <div class="section-header bounce-in">
    <div class="section-icon">ğŸ§²</div>
    <h2>Teil C: Magnetismus</h2>
    <div class="section-sub">VerstÃ¤ndnis & Multiple Choice Â· 8 Punkte</div>
  </div>

  <!-- Q5: VerstÃ¤ndnis Magnetismus (4P) -->
  <div class="q-card" id="q5">
    <span class="q-points">4 Punkte</span>
    <p class="q-title"><span class="q-number">5</span> Elementarmagnete & Magnetisierung</p>

    <div class="part-label">a) Elementarmagnetenmodell (2P)</div>
    <p style="margin-bottom:8px;">ErklÃ¤ren Sie mit dem Elementarmagnetenmodell: Warum hat jedes BruchstÃ¼ck eines geteilten Magneten immer noch einen Nord- <em>und</em> einen SÃ¼dpol?</p>
    <div class="mc-options" data-qid="q5a" data-correct="2">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Beim Teilen entstehen neue Pole durch die freiwerdende Energie
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Magnetische Pole existieren unabhÃ¤ngig voneinander
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> Jeder Elementarmagnet hat selbst einen Nord- und SÃ¼dpol. Teilt man den Magneten, behÃ¤lt jeder Elementarmagnet seine Pole â†’ immer N und S
      </div>
    </div>
    <div class="feedback" id="fb-q5a"></div>

    <hr class="sep">

    <div class="part-label">b) Entmagnetisierung (2P)</div>
    <p style="margin-bottom:8px;">Nennen Sie <strong>zwei Methoden</strong>, um einen magnetisierten Eisennagel zu entmagnetisieren:</p>
    <div class="mc-options" data-qid="q5b" data-correct="2">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> In Wasser legen und abkÃ¼hlen lassen
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> An einen stÃ¤rkeren Magneten halten
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> ErschÃ¼tterung (HÃ¤mmern) oder Erhitzen Ã¼ber die Curie-Temperatur
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">D</span> Unter Licht legen
      </div>
    </div>
    <div class="feedback" id="fb-q5b"></div>
  </div>

  <!-- Q6: Multiple Choice Magnetismus (4P) -->
  <div class="q-card" id="q6">
    <span class="q-points">4 Punkte</span>
    <p class="q-title"><span class="q-number">6</span> Magnetismus â€“ Multiple Choice</p>

    <div class="part-label">a) Ferromagnetische Materialien (2P)</div>
    <p style="margin-bottom:8px;">Welche der folgenden Materialien sind <strong>ferromagnetisch</strong>? (Mehrere Antworten mÃ¶glich!)</p>
    <div class="mc-options multi-select" data-qid="q6a" data-correct="0,2,4">
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Eisen (Fe)
      </div>
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Aluminium (Al)
      </div>
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Cobalt (Co)
      </div>
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Kupfer (Cu)
      </div>
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Nickel (Ni)
      </div>
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Holz
      </div>
    </div>
    <div class="feedback" id="fb-q6a"></div>

    <hr class="sep">

    <div class="part-label">b) Kompassnadel (2P)</div>
    <p style="margin-bottom:8px;">Warum zeigt die Kompassnadel nach Norden, obwohl sich dort der magnetische <em>SÃ¼dpol</em> der Erde befindet?</p>
    <div class="mc-options" data-qid="q6b" data-correct="1">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Der geographische Nordpol ist gleichzeitig der magnetische Nordpol
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Ungleichnamige Pole ziehen sich an: Der Nordpol der Kompassnadel wird vom magnetischen SÃ¼dpol (am geographischen Nordpol) angezogen
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> Die Kompassnadel zeigt eigentlich nach SÃ¼den, wir lesen sie nur falsch ab
      </div>
    </div>
    <div class="feedback" id="fb-q6b"></div>
  </div>

  <div class="nav-buttons">
    <button class="btn btn-outline btn-sm" onclick="goToSection(1)">â† E-Lehre</button>
    <button class="btn btn-primary btn-sm" onclick="goToSection(3)">Weiter: Chemie âš—ï¸ â†’</button>
  </div>
</div>

<!-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
     â•‘        TEIL D: CHEMIE (24 Punkte)         â•‘
     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="question-section" id="sectionD">
  <div class="section-header bounce-in">
    <div class="section-icon">âš—ï¸</div>
    <h2>Teil D: Chemie</h2>
    <div class="section-sub">Begriffe, Redox, SÃ¤ure-Base, Organik Â· 24 Punkte</div>
  </div>

  <!-- Q7: Begriffsdefinitionen (4P) -->
  <div class="q-card" id="q7">
    <span class="q-points">4 Punkte</span>
    <p class="q-title"><span class="q-number">7</span> Begriffsdefinitionen â€“ Zuordnung</p>
    <p style="margin-bottom:14px;">Ordnen Sie jeden Begriff der richtigen Definition zu:</p>

    <table class="q-table">
      <tr>
        <th>Begriff</th>
        <th>Definition</th>
      </tr>
      <tr>
        <td><strong>Oxidation</strong></td>
        <td>
          <select class="q-input" id="q7-ox" style="width:100%;">
            <option value="">â€“ auswÃ¤hlen â€“</option>
            <option value="eab">Elektronenabgabe (OZ steigt)</option>
            <option value="eauf">Elektronenaufnahme (OZ sinkt)</option>
            <option value="proto-ab">Protonenabgabe</option>
            <option value="proto-auf">Protonenaufnahme</option>
          </select>
        </td>
      </tr>
      <tr>
        <td><strong>Reduktion</strong></td>
        <td>
          <select class="q-input" id="q7-red" style="width:100%;">
            <option value="">â€“ auswÃ¤hlen â€“</option>
            <option value="eab">Elektronenabgabe (OZ steigt)</option>
            <option value="eauf">Elektronenaufnahme (OZ sinkt)</option>
            <option value="proto-ab">Protonenabgabe</option>
            <option value="proto-auf">Protonenaufnahme</option>
          </select>
        </td>
      </tr>
      <tr>
        <td><strong>SÃ¤ure (BrÃ¶nsted)</strong></td>
        <td>
          <select class="q-input" id="q7-saeure" style="width:100%;">
            <option value="">â€“ auswÃ¤hlen â€“</option>
            <option value="eab">Elektronenabgabe (OZ steigt)</option>
            <option value="eauf">Elektronenaufnahme (OZ sinkt)</option>
            <option value="proto-ab">Protonendonator (gibt Hâº ab)</option>
            <option value="proto-auf">Protonenakzeptor (nimmt Hâº auf)</option>
          </select>
        </td>
      </tr>
      <tr>
        <td><strong>Base (BrÃ¶nsted)</strong></td>
        <td>
          <select class="q-input" id="q7-base" style="width:100%;">
            <option value="">â€“ auswÃ¤hlen â€“</option>
            <option value="eab">Elektronenabgabe (OZ steigt)</option>
            <option value="eauf">Elektronenaufnahme (OZ sinkt)</option>
            <option value="proto-ab">Protonendonator (gibt Hâº ab)</option>
            <option value="proto-auf">Protonenakzeptor (nimmt Hâº auf)</option>
          </select>
        </td>
      </tr>
    </table>
    <div class="feedback" id="fb-q7"></div>
  </div>

  <!-- Q8: Redoxreaktion aufstellen (6P) -->
  <div class="q-card" id="q8">
    <span class="q-points">6 Punkte</span>
    <p class="q-title"><span class="q-number">8</span> Redoxreaktion: Magnesium + Sauerstoff</p>

    <div class="part-label">a) Oxidationszahlen bestimmen (2P)</div>
    <p style="margin-bottom:10px;" class="chem">Bestimmen Sie die Oxidationszahlen in <strong>MgO</strong>:</p>
    <div class="input-row">
      <label>Mg = </label>
      <input type="text" class="q-input" id="q8-mg" placeholder="?" style="width:80px;">
      <label style="margin-left:16px;">O = </label>
      <input type="text" class="q-input" id="q8-o" placeholder="?" style="width:80px;">
    </div>

    <hr class="sep">

    <div class="part-label">b) Teilgleichungen & Gesamtgleichung (4P)</div>
    <p style="margin-bottom:8px;">Stellen Sie die Redoxreaktion auf:</p>
    <p style="margin-bottom:8px; font-size:0.9em;"><strong>Oxidation</strong> (Mg gibt Elektronen ab):</p>
    <div class="input-row">
      <label>Mg â†’</label>
      <select class="q-input" id="q8-ox" style="min-width:200px;">
        <option value="">â€“ auswÃ¤hlen â€“</option>
        <option value="mg2+2e">MgÂ²âº + 2 eâ»</option>
        <option value="mg+1e">Mgâº + 1 eâ»</option>
        <option value="mg3+3e">MgÂ³âº + 3 eâ»</option>
      </select>
    </div>
    <p style="margin-bottom:8px; margin-top:12px; font-size:0.9em;"><strong>Reduktion</strong> (Oâ‚‚ nimmt Elektronen auf):</p>
    <div class="input-row">
      <label>Oâ‚‚ + 4eâ» â†’</label>
      <select class="q-input" id="q8-red" style="min-width:200px;">
        <option value="">â€“ auswÃ¤hlen â€“</option>
        <option value="2o2-">2 OÂ²â»</option>
        <option value="o2-">OÂ²â»</option>
        <option value="2o-">2 Oâ»</option>
      </select>
    </div>
    <p style="margin-bottom:8px; margin-top:12px; font-size:0.9em;"><strong>Gesamtgleichung</strong> (ausgeglichen):</p>
    <div class="input-row">
      <select class="q-input" id="q8-ges" style="min-width:280px;">
        <option value="">â€“ auswÃ¤hlen â€“</option>
        <option value="2mg+o2=2mgo">2 Mg + Oâ‚‚ â†’ 2 MgO</option>
        <option value="mg+o=mgo">Mg + O â†’ MgO</option>
        <option value="mg+o2=mgo2">Mg + Oâ‚‚ â†’ MgOâ‚‚</option>
        <option value="4mg+o2=4mgo">4 Mg + Oâ‚‚ â†’ 4 MgO</option>
      </select>
    </div>
    <div class="feedback" id="fb-q8"></div>
  </div>

  <!-- Q9: SÃ¤ure-Base-Paare (5P) -->
  <div class="q-card" id="q9">
    <span class="q-points">5 Punkte</span>
    <p class="q-title"><span class="q-number">9</span> SÃ¤ure-Base-Reaktion & Paare</p>

    <div class="part-label">a) Reaktion von HCl mit Wasser (3P)</div>
    <p style="margin-bottom:8px;">VervollstÃ¤ndigen Sie die Reaktionsgleichung und bestimmen Sie die korrespondierenden SÃ¤ure-Base-Paare:</p>
    <div class="equation-box chem">
      HCl + Hâ‚‚O â†’
      <select class="q-input" id="q9-prod" style="min-width:200px; margin-left:8px;">
        <option value="">Produkte?</option>
        <option value="h3o+cl-">Hâ‚ƒOâº + Clâ»</option>
        <option value="h2+cl-">Hâ‚‚ + Clâ»</option>
        <option value="oh-+hcl">OHâ» + HCl</option>
        <option value="nacl+h2o">NaCl + Hâ‚‚O</option>
      </select>
    </div>

    <p style="margin-top:12px; margin-bottom:8px; font-size:0.9em;">Korrespondierende Paare:</p>
    <div class="input-row">
      <label>SÃ¤ure-Base-Paar 1:</label>
      <select class="q-input" id="q9-pair1" style="min-width:200px;">
        <option value="">â€“ auswÃ¤hlen â€“</option>
        <option value="hcl-cl">HCl / Clâ»</option>
        <option value="h2o-oh">Hâ‚‚O / OHâ»</option>
        <option value="h3o-h2o">Hâ‚ƒOâº / Hâ‚‚O</option>
      </select>
    </div>
    <div class="input-row">
      <label>SÃ¤ure-Base-Paar 2:</label>
      <select class="q-input" id="q9-pair2" style="min-width:200px;">
        <option value="">â€“ auswÃ¤hlen â€“</option>
        <option value="hcl-cl">HCl / Clâ»</option>
        <option value="h2o-oh">Hâ‚‚O / OHâ»</option>
        <option value="h2o-h3o">Hâ‚‚O / Hâ‚ƒOâº</option>
      </select>
    </div>
    <div class="feedback" id="fb-q9a"></div>

    <hr class="sep">

    <div class="part-label">b) Neutralisation (2P)</div>
    <p style="margin-bottom:8px;">Schreiben Sie die Neutralisationsreaktion von <strong>SchwefelsÃ¤ure + Natronlauge</strong>:</p>
    <div class="input-row">
      <select class="q-input" id="q9-neutral" style="min-width:100%; max-width:100%;">
        <option value="">â€“ Reaktionsgleichung wÃ¤hlen â€“</option>
        <option value="h2so4+2naoh">Hâ‚‚SOâ‚„ + 2 NaOH â†’ Naâ‚‚SOâ‚„ + 2 Hâ‚‚O</option>
        <option value="h2so4+naoh">Hâ‚‚SOâ‚„ + NaOH â†’ NaSOâ‚„ + Hâ‚‚O</option>
        <option value="hcl+naoh">HCl + NaOH â†’ NaCl + Hâ‚‚O</option>
        <option value="h2so4+koh">Hâ‚‚SOâ‚„ + 2 KOH â†’ Kâ‚‚SOâ‚„ + 2 Hâ‚‚O</option>
      </select>
    </div>
    <div class="feedback" id="fb-q9b"></div>
  </div>

  <!-- Q10: Funktionelle Gruppen & Veresterung (5P) -->
  <div class="q-card" id="q10">
    <span class="q-points">5 Punkte</span>
    <p class="q-title"><span class="q-number">10</span> Funktionelle Gruppen & Reaktionen</p>

    <div class="part-label">a) Funktionelle Gruppen erkennen (3P)</div>
    <p style="margin-bottom:10px;">Ordnen Sie jeder Stoffklasse die richtige funktionelle Gruppe zu:</p>
    <table class="q-table">
      <tr><th>Stoffklasse</th><th>Funktionelle Gruppe</th></tr>
      <tr>
        <td>Alkohole</td>
        <td>
          <select class="q-input" id="q10-alk" style="width:100%;">
            <option value="">â€“</option>
            <option value="oh">âˆ’OH (Hydroxylgruppe)</option>
            <option value="cooh">âˆ’COOH (Carboxylgruppe)</option>
            <option value="coo">âˆ’COOâˆ’ (Estergruppe)</option>
            <option value="nh2">âˆ’NHâ‚‚ (Aminogruppe)</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>CarbonsÃ¤uren</td>
        <td>
          <select class="q-input" id="q10-carb" style="width:100%;">
            <option value="">â€“</option>
            <option value="oh">âˆ’OH (Hydroxylgruppe)</option>
            <option value="cooh">âˆ’COOH (Carboxylgruppe)</option>
            <option value="coo">âˆ’COOâˆ’ (Estergruppe)</option>
            <option value="nh2">âˆ’NHâ‚‚ (Aminogruppe)</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>Ester</td>
        <td>
          <select class="q-input" id="q10-ester" style="width:100%;">
            <option value="">â€“</option>
            <option value="oh">âˆ’OH (Hydroxylgruppe)</option>
            <option value="cooh">âˆ’COOH (Carboxylgruppe)</option>
            <option value="coo">âˆ’COOâˆ’ (Estergruppe)</option>
            <option value="nh2">âˆ’NHâ‚‚ (Aminogruppe)</option>
          </select>
        </td>
      </tr>
    </table>

    <hr class="sep">

    <div class="part-label">b) Veresterung (2P)</div>
    <p style="margin-bottom:10px;">Bei der Veresterung reagiert eine CarbonsÃ¤ure mit einem Alkohol. Welches Produkt und welches Nebenprodukt entstehen?</p>
    <div class="input-row">
      <label>EthansÃ¤ure + Ethanol â†’</label>
    </div>
    <div class="input-row">
      <label>Hauptprodukt:</label>
      <select class="q-input" id="q10-prod" style="min-width:220px;">
        <option value="">â€“</option>
        <option value="ester">EthansÃ¤ureethylester (ein Ester)</option>
        <option value="ether">Diethylether</option>
        <option value="alkan">Ethan</option>
      </select>
    </div>
    <div class="input-row">
      <label>Nebenprodukt:</label>
      <select class="q-input" id="q10-neben" style="min-width:220px;">
        <option value="">â€“</option>
        <option value="h2o">Wasser (Hâ‚‚O)</option>
        <option value="co2">COâ‚‚</option>
        <option value="h2">Wasserstoff (Hâ‚‚)</option>
      </select>
    </div>
    <div class="feedback" id="fb-q10"></div>
  </div>

  <div class="nav-buttons">
    <button class="btn btn-outline btn-sm" onclick="goToSection(2)">â† Magnetismus</button>
    <button class="btn btn-primary btn-sm" onclick="goToSection(4)">Weiter: Nachhaltigkeit ğŸŒ± â†’</button>
  </div>
</div>

<!-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
     â•‘   TEIL E: NACHHALTIGKEIT (12 Punkte)      â•‘
     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="question-section" id="sectionE">
  <div class="section-header bounce-in">
    <div class="section-icon">ğŸŒ±</div>
    <h2>Teil E: Nachhaltige Entwicklung</h2>
    <div class="section-sub">Kunststoffe, GrÃ¼ne Chemie, Umwelt Â· 12 Punkte</div>
  </div>

  <!-- Q11: Kunststoffe (6P) -->
  <div class="q-card" id="q11">
    <span class="q-points">6 Punkte</span>
    <p class="q-title"><span class="q-number">11</span> Kunststoffe & Recycling</p>

    <div class="part-label">a) Kunststoffklassen (3P)</div>
    <p style="margin-bottom:8px;">Ordnen Sie das Verhalten beim Erhitzen der richtigen Kunststoffklasse zu:</p>
    <table class="q-table">
      <tr><th>Verhalten beim Erhitzen</th><th>Kunststoffklasse</th></tr>
      <tr>
        <td>Wird weich, verformbar, beim AbkÃ¼hlen wieder fest</td>
        <td>
          <select class="q-input" id="q11-thermo" style="width:100%;">
            <option value="">â€“</option>
            <option value="thermo">Thermoplast</option>
            <option value="duro">Duroplast</option>
            <option value="elasto">Elastomer</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>Zersetzt sich, wird schwarz, nicht verformbar</td>
        <td>
          <select class="q-input" id="q11-duro" style="width:100%;">
            <option value="">â€“</option>
            <option value="thermo">Thermoplast</option>
            <option value="duro">Duroplast</option>
            <option value="elasto">Elastomer</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>Bleibt elastisch, kehrt in Ausgangsform zurÃ¼ck</td>
        <td>
          <select class="q-input" id="q11-elasto" style="width:100%;">
            <option value="">â€“</option>
            <option value="thermo">Thermoplast</option>
            <option value="duro">Duroplast</option>
            <option value="elasto">Elastomer</option>
          </select>
        </td>
      </tr>
    </table>

    <hr class="sep">

    <div class="part-label">b) Recycling (2P)</div>
    <p style="margin-bottom:8px;">Welche Kunststoffklasse kann <strong>werkstofflich recycelt</strong> werden und warum?</p>
    <div class="mc-options" data-qid="q11b" data-correct="0">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Thermoplaste â€“ sie lassen sich wiederholt aufschmelzen und neu formen
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Duroplaste â€“ sie sind besonders stabil
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> Elastomere â€“ sie sind flexibel und wiederverwendbar
      </div>
    </div>
    <div class="feedback" id="fb-q11b"></div>

    <hr class="sep">

    <div class="part-label">c) Downcycling (1P)</div>
    <p style="margin-bottom:8px;">Was bedeutet <strong>Downcycling</strong>?</p>
    <div class="mc-options" data-qid="q11c" data-correct="1">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Kunststoff wird zu einem besseren Produkt recycelt
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Kunststoff wird zu einem minderwertigen Produkt recycelt (QualitÃ¤tsverlust)
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> Kunststoff wird vollstÃ¤ndig in Monomere zerlegt
      </div>
    </div>
    <div class="feedback" id="fb-q11c"></div>
  </div>

  <!-- Q12: Nachhaltigkeit (6P) -->
  <div class="q-card" id="q12">
    <span class="q-points">6 Punkte</span>
    <p class="q-title"><span class="q-number">12</span> Nachhaltigkeit & Umwelt</p>

    <div class="part-label">a) PlastikmÃ¼ll im Meer (2P)</div>
    <p style="margin-bottom:8px;">Welche Probleme verursacht PlastikmÃ¼ll im Meer? (Mehrfachauswahl!)</p>
    <div class="mc-options multi-select" data-qid="q12a" data-correct="0,1,2">
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Tiere verwechseln Plastik mit Nahrung und verhungern
      </div>
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Mikroplastik gelangt in die Nahrungskette
      </div>
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Tiere verfangen sich in Plastikteilen
      </div>
      <div class="mc-option multi" onclick="toggleMultiMC(this)">
        <span class="letter">â˜</span> Plastik kÃ¼hlt das Meerwasser ab
      </div>
    </div>
    <div class="feedback" id="fb-q12a"></div>

    <hr class="sep">

    <div class="part-label">b) Biobasiert â‰  biologisch abbaubar (2P)</div>
    <p style="margin-bottom:8px;">Ein Hersteller bewirbt seinen Becher als â€biobasiert". Bedeutet das automatisch, dass er biologisch abbaubar ist?</p>
    <div class="mc-options" data-qid="q12b" data-correct="1">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Ja â€“ biobasiert bedeutet automatisch biologisch abbaubar
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Nein â€“ â€biobasiert" heiÃŸt nur, dass der Rohstoff aus nachwachsenden Quellen stammt. Die chemische Struktur entscheidet Ã¼ber die Abbaubarkeit
      </div>
    </div>
    <div class="feedback" id="fb-q12b"></div>

    <hr class="sep">

    <div class="part-label">c) Mehrweg vs. Einweg (2P)</div>
    <p style="margin-bottom:8px;">Warum sind <strong>Mehrwegprodukte</strong> Einwegprodukten (auch Bio-Einweg) Ã¼berlegen?</p>
    <div class="mc-options" data-qid="q12c" data-correct="2">
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">A</span> Mehrwegprodukte sind immer gÃ¼nstiger in der Herstellung
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">B</span> Mehrwegprodukte sehen besser aus
      </div>
      <div class="mc-option" onclick="selectMC(this)">
        <span class="letter">C</span> Durch mehrfache Nutzung wird weniger Rohstoff und Energie verbraucht â†’ geringerer Ã¶kologischer FuÃŸabdruck Ã¼ber den gesamten Lebenszyklus
      </div>
    </div>
    <div class="feedback" id="fb-q12c"></div>
  </div>

  <div class="nav-buttons">
    <button class="btn btn-outline btn-sm" onclick="goToSection(3)">â† Chemie</button>
    <button class="btn btn-primary" onclick="evaluateAll()">ğŸ† Auswerten & Ergebnis anzeigen</button>
  </div>
</div>

</div> <!-- /quizContainer -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RESULT SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="resultScreen" class="container">
  <div class="result-circle" id="resultCircle">
    <div class="result-circle-inner">
      <div class="pct" id="resultPct">0%</div>
      <div class="pct-label">erreicht</div>
    </div>
  </div>
  <div class="result-grade" id="resultGrade"></div>
  <p class="result-msg" id="resultMsg"></p>

  <div class="result-breakdown" id="resultBreakdown">
    <div class="result-cat">
      <div class="cat-icon">ğŸ”¦</div>
      <div class="cat-name">Optik</div>
      <div class="cat-score" id="cat-optik">0/14</div>
      <div class="cat-bar"><div class="cat-bar-fill" id="bar-optik" style="width:0%"></div></div>
    </div>
    <div class="result-cat">
      <div class="cat-icon">âš¡</div>
      <div class="cat-name">E-Lehre</div>
      <div class="cat-score" id="cat-elehre">0/12</div>
      <div class="cat-bar"><div class="cat-bar-fill" id="bar-elehre" style="width:0%"></div></div>
    </div>
    <div class="result-cat">
      <div class="cat-icon">ğŸ§²</div>
      <div class="cat-name">Magnetismus</div>
      <div class="cat-score" id="cat-magnet">0/8</div>
      <div class="cat-bar"><div class="cat-bar-fill" id="bar-magnet" style="width:0%"></div></div>
    </div>
    <div class="result-cat">
      <div class="cat-icon">âš—ï¸</div>
      <div class="cat-name">Chemie</div>
      <div class="cat-score" id="cat-chemie">0/24</div>
      <div class="cat-bar"><div class="cat-bar-fill" id="bar-chemie" style="width:0%"></div></div>
    </div>
    <div class="result-cat">
      <div class="cat-icon">ğŸŒ±</div>
      <div class="cat-name">Nachhaltigkeit</div>
      <div class="cat-score" id="cat-nachh">0/12</div>
      <div class="cat-bar"><div class="cat-bar-fill" id="bar-nachh" style="width:0%"></div></div>
    </div>
  </div>

  <button class="btn btn-primary" onclick="showSolutions()">ğŸ“‹ LÃ¶sungen anzeigen</button>
  <button class="btn btn-outline" style="margin-left:12px;" onclick="location.reload()">ğŸ”„ Nochmal</button>

  <div id="solutionsArea" style="display:none; text-align:left; margin-top:40px;">
    <h3 style="margin-bottom:16px; color:var(--gold);">ğŸ“‹ MusterlÃ¶sungen</h3>
    <div class="q-card" id="solutionContent" style="font-size:0.9em; line-height:1.8;"></div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GLOBALS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TOTAL_POINTS = 70;
let scores = { optik: 0, elehre: 0, magnet: 0, chemie: 0, nachh: 0 };
const sectionNames = ['sectionA','sectionB','sectionC','sectionD','sectionE'];
const sectionLabels = ['Teil A: Optik','Teil B: E-Lehre','Teil C: Magnetismus','Teil D: Chemie','Teil E: Nachhaltigkeit'];
let currentSection = 0;
let evaluated = false;

// Canvas state
let canvasStates = {};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PARTICLES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function createParticles() {
  const container = document.getElementById('particles');
  const colors = ['#6C63FF','#FF6584','#FFD700','#2ECC71','#3498DB'];
  for (let i = 0; i < 30; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const size = Math.random() * 6 + 3;
    p.style.width = size + 'px';
    p.style.height = size + 'px';
    p.style.left = Math.random() * 100 + '%';
    p.style.background = colors[Math.floor(Math.random() * colors.length)];
    p.style.animationDuration = (Math.random() * 20 + 15) + 's';
    p.style.animationDelay = (Math.random() * 15) + 's';
    container.appendChild(p);
  }
}
createParticles();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// START / NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startQuiz() {
  document.getElementById('startScreen').style.display = 'none';
  document.getElementById('quizContainer').style.display = 'block';
  document.getElementById('progressArea').style.display = 'block';
  updateProgress();
  initCanvases();
}

function goToSection(idx) {
  document.querySelectorAll('.question-section').forEach(s => s.classList.remove('active'));
  document.getElementById(sectionNames[idx]).classList.add('active');
  currentSection = idx;
  updateProgress();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function updateProgress() {
  const pct = ((currentSection + 1) / sectionNames.length) * 100;
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressLabel').textContent = sectionLabels[currentSection];
  const totalScore = Object.values(scores).reduce((a,b) => a+b, 0);
  document.getElementById('scoreBadge').textContent = 'â­ ' + totalScore + ' / ' + TOTAL_POINTS;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MC SINGLE SELECT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function selectMC(el) {
  if (evaluated) return;
  const parent = el.closest('.mc-options');
  if (parent.classList.contains('multi-select')) return;
  parent.querySelectorAll('.mc-option').forEach(o => o.classList.remove('selected'));
  el.classList.add('selected');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MC MULTI SELECT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleMultiMC(el) {
  if (evaluated) return;
  el.classList.toggle('selected');
  const letter = el.querySelector('.letter');
  letter.textContent = el.classList.contains('selected') ? 'â˜‘' : 'â˜';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CANVAS DRAWING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let drawColor = '#2ECC71';
let drawColor2 = '#FFD700';
let isDrawing = false;

function initCanvases() {
  setupCanvas('mirrorCanvas', drawMirrorScene);
  setupCanvas('shadowCanvas', drawShadowScene);
}

function setupCanvas(id, sceneFn) {
  const canvas = document.getElementById(id);
  const ctx = canvas.getContext('2d');
  canvasStates[id] = { strokes: [], currentStroke: null };

  // Draw scene
  sceneFn(ctx, canvas);

  // Store scene image
  canvasStates[id].sceneImage = ctx.getImageData(0, 0, canvas.width, canvas.height);

  canvas.addEventListener('mousedown', (e) => {
    isDrawing = true;
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;
    const x = (e.clientX - rect.left) * scaleX;
    const y = (e.clientY - rect.top) * scaleY;
    const color = id === 'mirrorCanvas' ? drawColor : drawColor2;
    canvasStates[id].currentStroke = { points: [{x, y}], color };
  });

  canvas.addEventListener('mousemove', (e) => {
    if (!isDrawing || !canvasStates[id].currentStroke) return;
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;
    const x = (e.clientX - rect.left) * scaleX;
    const y = (e.clientY - rect.top) * scaleY;
    canvasStates[id].currentStroke.points.push({x, y});
    redrawCanvas(id, id === 'mirrorCanvas' ? drawMirrorScene : drawShadowScene);
  });

  canvas.addEventListener('mouseup', () => {
    if (canvasStates[id].currentStroke && canvasStates[id].currentStroke.points.length > 1) {
      canvasStates[id].strokes.push(canvasStates[id].currentStroke);
    }
    canvasStates[id].currentStroke = null;
    isDrawing = false;
  });

  canvas.addEventListener('mouseleave', () => {
    if (isDrawing && canvasStates[id].currentStroke && canvasStates[id].currentStroke.points.length > 1) {
      canvasStates[id].strokes.push(canvasStates[id].currentStroke);
    }
    canvasStates[id].currentStroke = null;
    isDrawing = false;
  });

  // Touch support
  canvas.addEventListener('touchstart', (e) => {
    e.preventDefault();
    const touch = e.touches[0];
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;
    const x = (touch.clientX - rect.left) * scaleX;
    const y = (touch.clientY - rect.top) * scaleY;
    const color = id === 'mirrorCanvas' ? drawColor : drawColor2;
    canvasStates[id].currentStroke = { points: [{x, y}], color };
    isDrawing = true;
  });
  canvas.addEventListener('touchmove', (e) => {
    e.preventDefault();
    if (!canvasStates[id].currentStroke) return;
    const touch = e.touches[0];
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;
    const x = (touch.clientX - rect.left) * scaleX;
    const y = (touch.clientY - rect.top) * scaleY;
    canvasStates[id].currentStroke.points.push({x, y});
    redrawCanvas(id, id === 'mirrorCanvas' ? drawMirrorScene : drawShadowScene);
  });
  canvas.addEventListener('touchend', (e) => {
    e.preventDefault();
    if (canvasStates[id].currentStroke && canvasStates[id].currentStroke.points.length > 1) {
      canvasStates[id].strokes.push(canvasStates[id].currentStroke);
    }
    canvasStates[id].currentStroke = null;
    isDrawing = false;
  });
}

function redrawCanvas(id, sceneFn) {
  const canvas = document.getElementById(id);
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  sceneFn(ctx, canvas);
  // Draw all strokes
  const state = canvasStates[id];
  const allStrokes = [...state.strokes];
  if (state.currentStroke) allStrokes.push(state.currentStroke);
  allStrokes.forEach(stroke => {
    if (stroke.points.length < 2) return;
    ctx.beginPath();
    ctx.strokeStyle = stroke.color;
    ctx.lineWidth = 3;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    ctx.moveTo(stroke.points[0].x, stroke.points[0].y);
    for (let i = 1; i < stroke.points.length; i++) {
      ctx.lineTo(stroke.points[i].x, stroke.points[i].y);
    }
    ctx.stroke();
  });
}

function drawMirrorScene(ctx, canvas) {
  const w = canvas.width, h = canvas.height;
  ctx.fillStyle = '#1a1a2e';
  ctx.fillRect(0, 0, w, h);

  // Mirror (vertical line in center)
  ctx.strokeStyle = '#6C63FF';
  ctx.lineWidth = 6;
  ctx.beginPath();
  ctx.moveTo(w/2, 40);
  ctx.lineTo(w/2, h-40);
  ctx.stroke();
  ctx.fillStyle = '#6C63FF';
  ctx.font = '16px Poppins';
  ctx.fillText('Spiegel', w/2 - 30, 30);

  // Lot (dashed, horizontal through incident point)
  ctx.strokeStyle = 'rgba(255,255,255,0.3)';
  ctx.lineWidth = 1;
  ctx.setLineDash([8, 6]);
  ctx.beginPath();
  const incidentY = h * 0.45;
  ctx.moveTo(w/2 - 200, incidentY);
  ctx.lineTo(w/2 + 200, incidentY);
  ctx.stroke();
  ctx.setLineDash([]);
  ctx.fillStyle = 'rgba(255,255,255,0.4)';
  ctx.font = '12px Poppins';
  ctx.fillText('Lot (senkrecht zum Spiegel)', w/2 + 60, incidentY - 8);

  // Actually I need the Lot perpendicular to mirror surface. Mirror is vertical, so Lot is horizontal.
  // Incoming ray from top-left hitting mirror at angle
  const hitX = w/2;
  const hitY = h * 0.45;
  const startX = 80;
  const startY = 80;

  // Incoming ray (yellow)
  ctx.strokeStyle = '#FFD700';
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.moveTo(startX, startY);
  ctx.lineTo(hitX, hitY);
  ctx.stroke();

  // Arrow on incoming ray
  drawArrow(ctx, startX, startY, hitX, hitY, '#FFD700');

  // Labels
  ctx.fillStyle = '#FFD700';
  ctx.font = '14px Poppins';
  ctx.fillText('Einfallender Strahl', startX, startY - 10);

  // Angle arc label
  ctx.fillStyle = 'rgba(255,255,255,0.6)';
  ctx.font = '13px Poppins';
  ctx.fillText('Î± â‰ˆ 40Â°', hitX - 130, hitY - 30);

  // Instruction
  ctx.fillStyle = '#2ECC71';
  ctx.font = '14px Poppins';
  ctx.fillText('â†’ Zeichne den reflektierten Strahl (grÃ¼n)!', hitX + 30, hitY + 50);
  ctx.fillText('   Einfallswinkel = Ausfallswinkel', hitX + 30, hitY + 70);
}

function drawArrow(ctx, x1, y1, x2, y2, color) {
  const angle = Math.atan2(y2-y1, x2-x1);
  const len = 12;
  ctx.fillStyle = color;
  ctx.beginPath();
  ctx.moveTo(x2, y2);
  ctx.lineTo(x2 - len*Math.cos(angle-0.4), y2 - len*Math.sin(angle-0.4));
  ctx.lineTo(x2 - len*Math.cos(angle+0.4), y2 - len*Math.sin(angle+0.4));
  ctx.closePath();
  ctx.fill();
}

function drawShadowScene(ctx, canvas) {
  const w = canvas.width, h = canvas.height;
  ctx.fillStyle = '#1a1a2e';
  ctx.fillRect(0, 0, w, h);

  // Floor
  ctx.strokeStyle = 'rgba(255,255,255,0.15)';
  ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.moveTo(0, h - 60);
  ctx.lineTo(w, h - 60);
  ctx.stroke();

  // Light source (left)
  ctx.fillStyle = '#FFD700';
  ctx.beginPath();
  ctx.arc(100, h - 140, 18, 0, Math.PI * 2);
  ctx.fill();
  ctx.fillStyle = '#FFD700';
  ctx.font = '24px serif';
  ctx.fillText('â˜€ï¸', 86, h - 100);
  ctx.font = '13px Poppins';
  ctx.fillStyle = '#FFD700';
  ctx.fillText('Punktlichtquelle', 55, h - 170);

  // Object (middle)
  ctx.fillStyle = '#E74C3C';
  ctx.fillRect(370, h - 180, 20, 120);
  ctx.fillStyle = '#fff';
  ctx.font = '13px Poppins';
  ctx.fillText('Gegenstand', 345, h - 190);

  // Wall (right)
  ctx.fillStyle = 'rgba(108,99,255,0.3)';
  ctx.fillRect(680, h - 300, 16, 240);
  ctx.fillStyle = '#6C63FF';
  ctx.font = '13px Poppins';
  ctx.fillText('Wand', 680, h - 310);

  // Instruction
  ctx.fillStyle = 'rgba(255,255,255,0.5)';
  ctx.font = '13px Poppins';
  ctx.fillText('â†’ Zeichne Randstrahlen (gelb) und markiere den Schatten (grau) auf der Wand!', 100, 30);
}

function setDrawColor(color, el) {
  drawColor = color;
  el.closest('.canvas-tools').querySelectorAll('.btn-tool').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
}
function setDrawColor2(color, el) {
  drawColor2 = color;
  el.closest('.canvas-tools').querySelectorAll('.btn-tool').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
}

function clearCanvas(id) {
  canvasStates[id].strokes = [];
  canvasStates[id].currentStroke = null;
  redrawCanvas(id, id === 'mirrorCanvas' ? drawMirrorScene : drawShadowScene);
}

function undoCanvas(id) {
  canvasStates[id].strokes.pop();
  redrawCanvas(id, id === 'mirrorCanvas' ? drawMirrorScene : drawShadowScene);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EVALUATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function evaluateAll() {
  if (evaluated) return;
  evaluated = true;

  scores = { optik: 0, elehre: 0, magnet: 0, chemie: 0, nachh: 0 };

  // â”€â”€â”€ Q1: Optik VerstÃ¤ndnis (7P) â”€â”€â”€
  scores.optik += evalMC('q1a', 'fb-q1a', 2,
    'Richtig! Von optisch dÃ¼nnerem zu optisch dichterem Medium â†’ Brechung zum Lot hin.',
    'Falsch. Von dÃ¼nn zu dicht (Luftâ†’Wasser) â†’ Brechung zum Lot hin.');
  scores.optik += evalMC('q1b', 'fb-q1b', 2,
    'Richtig! Totalreflexion tritt nur beim Ãœbergang dichtâ†’dÃ¼nn auf, wenn Î± > Grenzwinkel.',
    'Falsch. Totalreflexion: dichtâ†’dÃ¼nn, wenn Einfallswinkel > Grenzwinkel.');
  scores.optik += evalMC('q1c', 'fb-q1c', 1,
    'Richtig! Glasfaserkabel nutzen Totalreflexion zur LichtÃ¼bertragung.',
    'Falsch. Glasfaserkabel (Lichtleiter) nutzen Totalreflexion.');

  // Q1d
  let q1dPts = 0;
  const swap = document.getElementById('q1d-swap').value;
  const size = document.getElementById('q1d-size').value.trim();
  if (swap === 'vorne-hinten') q1dPts += 1;
  if (size === '90' || size === '90 cm' || size === '90cm') q1dPts += 1;
  scores.optik += q1dPts;
  showFeedback('fb-q1d', q1dPts >= 2,
    'Richtig! Vertauscht wird vorne/hinten. SpiegelgrÃ¶ÃŸe = halbe KÃ¶rpergrÃ¶ÃŸe = 90 cm.',
    `LÃ¶sung: Vertauscht wird vorne/hinten. SpiegelgrÃ¶ÃŸe = 90 cm (halbe KÃ¶rpergrÃ¶ÃŸe, unabhÃ¤ngig vom Abstand). Du hast ${q1dPts}/2 P.`);

  // â”€â”€â”€ Q2: Zeichnung (7P) â€“ generous: always give at least base points for attempt â”€â”€â”€
  const mirrorStrokes = canvasStates['mirrorCanvas']?.strokes?.length || 0;
  const shadowStrokes = canvasStates['shadowCanvas']?.strokes?.length || 0;
  let drawPts = 0;
  if (mirrorStrokes >= 1) drawPts += Math.min(4, mirrorStrokes >= 2 ? 4 : 2);
  if (shadowStrokes >= 1) drawPts += Math.min(3, shadowStrokes >= 2 ? 3 : 1);
  scores.optik += drawPts;

  // â”€â”€â”€ Q3: E-Lehre Rechnung (7P) â”€â”€â”€
  const q3a = document.getElementById('q3a').value.trim().replace(/\s/g,'').replace('Î©','').replace('Ohm','');
  const q3b = document.getElementById('q3b').value.trim().replace(/\s/g,'').replace('A','');
  const q3c1 = document.getElementById('q3c1').value.trim().replace(/\s/g,'').replace('V','');
  const q3c2 = document.getElementById('q3c2').value.trim().replace(/\s/g,'').replace('V','');
  const q3d1 = document.getElementById('q3d1').value.trim().replace(/\s/g,'').replace('A','');
  const q3d2 = document.getElementById('q3d2').value;

  if (q3a === '50') { scores.elehre += 1; markInput('q3a', true); } else markInput('q3a', false);
  if (q3b === '0,2' || q3b === '0.2') { scores.elehre += 2; markInput('q3b', true); } else markInput('q3b', false);
  if (q3c1 === '4') { scores.elehre += 1; markInput('q3c1', true); } else markInput('q3c1', false);
  if (q3c2 === '6') { scores.elehre += 1; markInput('q3c2', true); } else markInput('q3c2', false);

  let q3dPts = 0;
  const d1Vals = ['8,7','8.7','â‰ˆ8,7','~8,7','8,69','8.69','8,70','8.70','ca.8,7','~9','â‰ˆ9','8.696'];
  if (d1Vals.some(v => q3d1.replace(',','.').replace('â‰ˆ','').replace('~','').replace('ca.','') === v.replace(',','.').replace('â‰ˆ','').replace('~','').replace('ca.','')) || q3d1.replace(',','.') === '8.7' || q3d1.replace(',','.') === '8.69' || q3d1.replace(',','.').startsWith('8.7')) {
    q3dPts += 1; markInput('q3d1', true);
  } else markInput('q3d1', false);
  if (q3d2 === 'nein') { q3dPts += 1; } 
  scores.elehre += q3dPts;

  showFeedback('fb-q3', scores.elehre >= 5,
    `Sehr gut! Du hast ${Math.min(7, scores.elehre)}/7 P bei den Berechnungen.`,
    `LÃ¶sungen: R=50Î©, I=0,2A, Uâ‚=4V, Uâ‚‚=6V, Iâ‰ˆ8,7A â†’ 2Ã—8,7=17,4A>16A â†’ Nein. Du hast ${Math.min(7, scores.elehre)}/7 P.`);

  // â”€â”€â”€ Q4: E-Lehre VerstÃ¤ndnis (5P) â”€â”€â”€
  scores.elehre += evalMC('q4a', 'fb-q4a', 2,
    'Richtig! Strom wird nicht verbraucht, sondern elektrische Energie umgewandelt.',
    'Falsch. Die StromstÃ¤rke ist Ã¼berall gleich â€“ es wird Energie umgewandelt, nicht Strom verbraucht.');
  scores.elehre += evalMC('q4b', 'fb-q4b', 1,
    'Richtig! Amperemeter in Reihe.',
    'Falsch. Amperemeter: in Reihe (muss vom gesamten Strom durchflossen werden).');

  const q4c = document.getElementById('q4c').value.trim().replace(/\s/g,'').replace('V','');
  const q4c2 = document.getElementById('q4c2').value.trim();
  let q4cPts = 0;
  if (q4c === '5') { q4cPts += 1; markInput('q4c', true); } else markInput('q4c', false);
  if (q4c2 === '39') { q4cPts += 1; markInput('q4c2', true); } else markInput('q4c2', false);
  scores.elehre += q4cPts;
  showFeedback('fb-q4c', q4cPts >= 2,
    'Richtig! 230/46 = 5V pro LÃ¤mpchen. 230/6 â‰ˆ 38,3 â†’ mindestens 39 StÃ¼ck.',
    `LÃ¶sung: 230Ã·46 = 5V, und 230Ã·6 = 38,3 â†’ aufgerundet 39 LÃ¤mpchen. Du hast ${q4cPts}/2 P.`);

  // â”€â”€â”€ Q5: Magnetismus VerstÃ¤ndnis (4P) â”€â”€â”€
  scores.magnet += evalMC('q5a', 'fb-q5a', 2,
    'Richtig! Jeder Elementarmagnet hat N+S. Teilen Ã¤ndert das nicht.',
    'Falsch. Jeder Elementarmagnet hat selbst N+S â†’ beim Teilen bleiben immer beide Pole.');
  scores.magnet += evalMC('q5b', 'fb-q5b', 2,
    'Richtig! HÃ¤mmern oder Erhitzen Ã¼ber Curie-Temperatur zerstÃ¶rt die Ausrichtung.',
    'Falsch. Entmagnetisierung: ErschÃ¼tterung (HÃ¤mmern) oder Erhitzen Ã¼ber Curie-Temperatur.');

  // â”€â”€â”€ Q6: Magnetismus MC (4P) â”€â”€â”€
  scores.magnet += evalMultiMC('q6a', 'fb-q6a', 2,
    'Richtig! Eisen, Cobalt und Nickel sind ferromagnetisch.',
    'Falsch. Ferromagnetisch: Eisen (Fe), Cobalt (Co), Nickel (Ni).');
  scores.magnet += evalMC('q6b', 'fb-q6b', 2,
    'Richtig! Ungleichnamige Pole ziehen sich an.',
    'Falsch. Der Nordpol der Nadel wird vom mag. SÃ¼dpol der Erde (am geogr. Nordpol) angezogen.');

  // â”€â”€â”€ Q7: Begriffsdefinitionen (4P) â”€â”€â”€
  let q7Pts = 0;
  if (document.getElementById('q7-ox').value === 'eab') q7Pts++;
  if (document.getElementById('q7-red').value === 'eauf') q7Pts++;
  if (document.getElementById('q7-saeure').value === 'proto-ab') q7Pts++;
  if (document.getElementById('q7-base').value === 'proto-auf') q7Pts++;
  scores.chemie += q7Pts;
  showFeedback('fb-q7', q7Pts >= 4,
    `Perfekt! Alle ${q7Pts}/4 Zuordnungen richtig.`,
    `LÃ¶sung: Oxidation=Elektronenabgabe, Reduktion=Elektronenaufnahme, SÃ¤ure=Protonendonator, Base=Protonenakzeptor. Du hast ${q7Pts}/4 P.`);

  // â”€â”€â”€ Q8: Redox (6P) â”€â”€â”€
  let q8Pts = 0;
  const mg = document.getElementById('q8-mg').value.trim();
  const o = document.getElementById('q8-o').value.trim();
  if (mg === '+II' || mg === '+2' || mg === 'II' || mg === '2' || mg === '+ii') { q8Pts++; markInput('q8-mg', true); } else markInput('q8-mg', false);
  if (o === '-II' || o === '-2' || o === '-ii' || o === 'âˆ’II' || o === 'âˆ’2') { q8Pts++; markInput('q8-o', true); } else markInput('q8-o', false);
  if (document.getElementById('q8-ox').value === 'mg2+2e') q8Pts++;
  if (document.getElementById('q8-red').value === '2o2-') q8Pts++;
  if (document.getElementById('q8-ges').value === '2mg+o2=2mgo') q8Pts += 2;
  scores.chemie += q8Pts;
  showFeedback('fb-q8', q8Pts >= 5,
    `Sehr gut! ${q8Pts}/6 Punkte bei der Redox.`,
    `LÃ¶sung: Mg=+II, O=âˆ’II. Ox: Mgâ†’MgÂ²âº+2eâ», Red: Oâ‚‚+4eâ»â†’2OÂ²â», Ges: 2Mg+Oâ‚‚â†’2MgO. Du hast ${q8Pts}/6 P.`);

  // â”€â”€â”€ Q9: SÃ¤ure-Base (5P) â”€â”€â”€
  let q9aPts = 0;
  if (document.getElementById('q9-prod').value === 'h3o+cl-') q9aPts++;
  if (document.getElementById('q9-pair1').value === 'hcl-cl') q9aPts++;
  if (document.getElementById('q9-pair2').value === 'h2o-h3o') q9aPts++;
  scores.chemie += q9aPts;
  showFeedback('fb-q9a', q9aPts >= 3,
    `Richtig! HCl+Hâ‚‚Oâ†’Hâ‚ƒOâº+Clâ». Paare: HCl/Clâ» und Hâ‚‚O/Hâ‚ƒOâº. ${q9aPts}/3 P.`,
    `LÃ¶sung: HCl+Hâ‚‚Oâ†’Hâ‚ƒOâº+Clâ». Paar 1: HCl/Clâ», Paar 2: Hâ‚‚O/Hâ‚ƒOâº. Du hast ${q9aPts}/3 P.`);

  let q9bPts = 0;
  if (document.getElementById('q9-neutral').value === 'h2so4+2naoh') q9bPts += 2;
  scores.chemie += q9bPts;
  showFeedback('fb-q9b', q9bPts >= 2,
    'Richtig! Hâ‚‚SOâ‚„ + 2 NaOH â†’ Naâ‚‚SOâ‚„ + 2 Hâ‚‚O.',
    'LÃ¶sung: Hâ‚‚SOâ‚„ + 2 NaOH â†’ Naâ‚‚SOâ‚„ + 2 Hâ‚‚O.');

  // â”€â”€â”€ Q10: Funktion. Gruppen (5P) â”€â”€â”€
  let q10Pts = 0;
  if (document.getElementById('q10-alk').value === 'oh') q10Pts++;
  if (document.getElementById('q10-carb').value === 'cooh') q10Pts++;
  if (document.getElementById('q10-ester').value === 'coo') q10Pts++;
  if (document.getElementById('q10-prod').value === 'ester') q10Pts++;
  if (document.getElementById('q10-neben').value === 'h2o') q10Pts++;
  scores.chemie += q10Pts;
  showFeedback('fb-q10', q10Pts >= 4,
    `Super! ${q10Pts}/5 Punkte. Alkohole=âˆ’OH, CarbonsÃ¤uren=âˆ’COOH, Ester=âˆ’COOâˆ’. Veresterung ergibt Ester+Wasser.`,
    `LÃ¶sung: Alkohol=âˆ’OH, CarbonsÃ¤ure=âˆ’COOH, Ester=âˆ’COOâˆ’. EthansÃ¤ure+Ethanolâ†’EthansÃ¤ureethylester+Wasser. Du hast ${q10Pts}/5 P.`);

  // â”€â”€â”€ Q11: Kunststoffe (6P) â”€â”€â”€
  let q11Pts = 0;
  if (document.getElementById('q11-thermo').value === 'thermo') q11Pts++;
  if (document.getElementById('q11-duro').value === 'duro') q11Pts++;
  if (document.getElementById('q11-elasto').value === 'elasto') q11Pts++;
  scores.nachh += q11Pts;
  scores.nachh += evalMC('q11b', 'fb-q11b', 2,
    'Richtig! Thermoplaste lassen sich aufschmelzen und neu formen.',
    'Falsch. Nur Thermoplaste: wiederholtes Aufschmelzen mÃ¶glich.');
  scores.nachh += evalMC('q11c', 'fb-q11c', 1,
    'Richtig! Downcycling = Recycling mit QualitÃ¤tsverlust.',
    'Falsch. Downcycling = Produkt minderer QualitÃ¤t entsteht.');

  // â”€â”€â”€ Q12: Nachhaltigkeit (6P) â”€â”€â”€
  scores.nachh += evalMultiMC('q12a', 'fb-q12a', 2,
    'Richtig! Verwechslung mit Nahrung, Mikroplastik in Nahrungskette, Verfangen.',
    'Falsch. Probleme: Verwechslung mit Nahrung, Mikroplastik, Verfangen in Plastikteilen.');
  scores.nachh += evalMC('q12b', 'fb-q12b', 2,
    'Richtig! Biobasiert â‰  biologisch abbaubar.',
    'Falsch. â€Biobasiert" sagt nichts Ã¼ber Abbaubarkeit. Die chemische Struktur entscheidet.');
  scores.nachh += evalMC('q12c', 'fb-q12c', 2,
    'Richtig! Mehrfachnutzung spart Ressourcen und Energie.',
    'Falsch. Mehrweg: weniger Rohstoff + Energie Ã¼ber den Lebenszyklus.');

  // Cap scores
  scores.optik = Math.min(14, scores.optik);
  scores.elehre = Math.min(12, scores.elehre);
  scores.magnet = Math.min(8, scores.magnet);
  scores.chemie = Math.min(24, scores.chemie);
  scores.nachh = Math.min(12, scores.nachh);

  updateProgress();
  showResults();
}

function evalMC(qid, fbId, pts, correctMsg, wrongMsg) {
  const container = document.querySelector(`[data-qid="${qid}"]`);
  const correctIdx = parseInt(container.dataset.correct);
  const options = container.querySelectorAll('.mc-option');
  let selectedIdx = -1;
  options.forEach((o, i) => { if (o.classList.contains('selected')) selectedIdx = i; });

  options[correctIdx].classList.add('correct-answer');
  if (selectedIdx >= 0 && selectedIdx !== correctIdx) {
    options[selectedIdx].classList.add('wrong-answer');
  }

  const isCorrect = selectedIdx === correctIdx;
  showFeedback(fbId, isCorrect, correctMsg, wrongMsg);
  return isCorrect ? pts : 0;
}

function evalMultiMC(qid, fbId, pts, correctMsg, wrongMsg) {
  const container = document.querySelector(`[data-qid="${qid}"]`);
  const correctIndices = container.dataset.correct.split(',').map(Number);
  const options = container.querySelectorAll('.mc-option');
  let selectedIndices = [];
  options.forEach((o, i) => { if (o.classList.contains('selected')) selectedIndices.push(i); });

  // Mark correct
  correctIndices.forEach(i => options[i].classList.add('correct-answer'));
  selectedIndices.forEach(i => {
    if (!correctIndices.includes(i)) options[i].classList.add('wrong-answer');
  });

  const isCorrect = correctIndices.length === selectedIndices.length &&
    correctIndices.every(i => selectedIndices.includes(i));
  showFeedback(fbId, isCorrect, correctMsg, wrongMsg);
  return isCorrect ? pts : (selectedIndices.filter(i => correctIndices.includes(i)).length > 0 ? Math.floor(pts/2) : 0);
}

function showFeedback(id, isCorrect, correctMsg, wrongMsg) {
  const fb = document.getElementById(id);
  fb.classList.add('show');
  fb.classList.add(isCorrect ? 'correct-fb' : 'wrong-fb');
  fb.innerHTML = (isCorrect ? 'âœ… ' : 'âŒ ') + (isCorrect ? correctMsg : wrongMsg);
}

function markInput(id, correct) {
  const el = document.getElementById(id);
  el.classList.add(correct ? 'correct-input' : 'wrong-input');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RESULTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showResults() {
  document.getElementById('quizContainer').style.display = 'none';
  document.getElementById('progressArea').style.display = 'none';
  document.getElementById('resultScreen').style.display = 'block';

  const total = scores.optik + scores.elehre + scores.magnet + scores.chemie + scores.nachh;
  const pct = Math.round((total / TOTAL_POINTS) * 100);

  // Animate percentage
  document.getElementById('resultCircle').style.setProperty('--score-pct', pct + '%');
  let counter = 0;
  const interval = setInterval(() => {
    counter += 2;
    if (counter > pct) { counter = pct; clearInterval(interval); }
    document.getElementById('resultPct').textContent = counter + '%';
  }, 30);

  // Grade
  let grade, msg;
  if (pct >= 90) { grade = 'ğŸ† Ausgezeichnet!'; msg = 'Du beherrschst die Themen hervorragend!'; }
  else if (pct >= 75) { grade = 'ğŸŒŸ Sehr gut!'; msg = 'Starke Leistung â€“ nur Kleinigkeiten zu verbessern.'; }
  else if (pct >= 60) { grade = 'ğŸ‘ Gut!'; msg = 'Solide Grundlagen â€“ schau dir die Fehler nochmal an.'; }
  else if (pct >= 45) { grade = 'ğŸ“š Ausreichend'; msg = 'Einige Themen solltest du nochmal wiederholen.'; }
  else { grade = 'ğŸ“– Noch Ã¼ben!'; msg = 'Nicht schlimm â€“ wiederhole die Themen und versuche es nochmal!'; }

  document.getElementById('resultGrade').textContent = grade;
  document.getElementById('resultMsg').textContent = `${total} von ${TOTAL_POINTS} Punkten Â· ${msg}`;

  // Category bars
  document.getElementById('cat-optik').textContent = scores.optik + '/14';
  document.getElementById('cat-elehre').textContent = scores.elehre + '/12';
  document.getElementById('cat-magnet').textContent = scores.magnet + '/8';
  document.getElementById('cat-chemie').textContent = scores.chemie + '/24';
  document.getElementById('cat-nachh').textContent = scores.nachh + '/12';

  setTimeout(() => {
    document.getElementById('bar-optik').style.width = (scores.optik/14*100) + '%';
    document.getElementById('bar-elehre').style.width = (scores.elehre/12*100) + '%';
    document.getElementById('bar-magnet').style.width = (scores.magnet/8*100) + '%';
    document.getElementById('bar-chemie').style.width = (scores.chemie/24*100) + '%';
    document.getElementById('bar-nachh').style.width = (scores.nachh/12*100) + '%';
  }, 300);

  // Confetti for good results
  if (pct >= 60) spawnConfetti();

  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function spawnConfetti() {
  const colors = ['#FF6584','#6C63FF','#FFD700','#2ECC71','#3498DB','#E74C3C','#FF9800'];
  for (let i = 0; i < 80; i++) {
    const c = document.createElement('div');
    c.className = 'confetti-piece';
    c.style.left = Math.random() * 100 + 'vw';
    c.style.background = colors[Math.floor(Math.random() * colors.length)];
    c.style.width = (Math.random() * 10 + 5) + 'px';
    c.style.height = (Math.random() * 10 + 5) + 'px';
    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
    c.style.animationDuration = (Math.random() * 2 + 2) + 's';
    c.style.animationDelay = (Math.random() * 2) + 's';
    document.body.appendChild(c);
    setTimeout(() => c.remove(), 5000);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SOLUTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showSolutions() {
  const area = document.getElementById('solutionsArea');
  area.style.display = 'block';
  document.getElementById('solutionContent').innerHTML = `
    <h4 style="color:var(--primary);">ğŸ”¦ Teil A: Optik</h4>
    <p><strong>1a)</strong> Zum Lot hin â€“ von optisch dÃ¼nnerem (Luft, n=1) zu dichterem Medium (Wasser, n=1,33).</p>
    <p><strong>1b)</strong> Totalreflexion: Beim Ãœbergang dichtâ†’dÃ¼nn, wenn Einfallswinkel > Grenzwinkel.</p>
    <p><strong>1c)</strong> Glasfaserkabel / Lichtleiter.</p>
    <p><strong>1d)</strong> Spiegel vertauscht vorne und hinten. MindestgrÃ¶ÃŸe = 90 cm (halbe KÃ¶rpergrÃ¶ÃŸe).</p>
    <p><strong>2a)</strong> Reflexionsgesetz: Einfallswinkel = Ausfallswinkel (vom Lot gemessen).</p>
    <p><strong>2b)</strong> Randstrahlen an Oberkante und Unterkante des Gegenstands â†’ Schattenbereich auf der Wand.</p>
    <hr class="sep">

    <h4 style="color:var(--primary);">âš¡ Teil B: ElektrizitÃ¤tslehre</h4>
    <p><strong>3a)</strong> R<sub>ges</sub> = 20 + 30 = 50 Î©</p>
    <p><strong>3b)</strong> I = U/R = 10/50 = 0,2 A</p>
    <p><strong>3c)</strong> Uâ‚ = 0,2 Ã— 20 = 4 V;  Uâ‚‚ = 0,2 Ã— 30 = 6 V</p>
    <p><strong>3d)</strong> I = 2000/230 â‰ˆ 8,7 A. Zwei GerÃ¤te: 17,4 A > 16 A â†’ Nein!</p>
    <p><strong>4a)</strong> Strom wird nicht verbraucht. I ist Ã¼berall gleich. Elektrische Energie wird umgewandelt.</p>
    <p><strong>4b)</strong> Amperemeter: in Reihe. Voltmeter: parallel.</p>
    <p><strong>4c)</strong> 230/46 = 5 V. Mindestens 230/6 â‰ˆ 38,3 â†’ 39 LÃ¤mpchen.</p>
    <hr class="sep">

    <h4 style="color:var(--primary);">ğŸ§² Teil C: Magnetismus</h4>
    <p><strong>5a)</strong> Jeder Elementarmagnet hat N+S. Teilen â†’ jedes StÃ¼ck hat noch N+S.</p>
    <p><strong>5b)</strong> Entmagnetisierung: (1) ErschÃ¼tterung/HÃ¤mmern, (2) Erhitzen Ã¼ber Curie-Temperatur.</p>
    <p><strong>6a)</strong> Ferromagnetisch: Eisen (Fe), Cobalt (Co), Nickel (Ni).</p>
    <p><strong>6b)</strong> Ungleichnamige Pole ziehen sich an: Kompass-Nordpol â†’ mag. SÃ¼dpol der Erde (am geogr. Nordpol).</p>
    <hr class="sep">

    <h4 style="color:var(--primary);">âš—ï¸ Teil D: Chemie</h4>
    <p><strong>7)</strong> Oxidation = Elektronenabgabe (OZ steigt); Reduktion = Elektronenaufnahme (OZ sinkt); SÃ¤ure = Protonendonator; Base = Protonenakzeptor.</p>
    <p><strong>8)</strong> MgO: Mg = +II, O = âˆ’II. Ox: Mg â†’ MgÂ²âº + 2eâ». Red: Oâ‚‚ + 4eâ» â†’ 2OÂ²â». Gesamt: 2 Mg + Oâ‚‚ â†’ 2 MgO.</p>
    <p><strong>9a)</strong> HCl + Hâ‚‚O â†’ Hâ‚ƒOâº + Clâ». Paar 1: HCl/Clâ». Paar 2: Hâ‚‚O/Hâ‚ƒOâº.</p>
    <p><strong>9b)</strong> Hâ‚‚SOâ‚„ + 2 NaOH â†’ Naâ‚‚SOâ‚„ + 2 Hâ‚‚O.</p>
    <p><strong>10a)</strong> Alkohole = âˆ’OH, CarbonsÃ¤uren = âˆ’COOH, Ester = âˆ’COOâˆ’.</p>
    <p><strong>10b)</strong> EthansÃ¤ure + Ethanol â†’ EthansÃ¤ureethylester + Wasser.</p>
    <hr class="sep">

    <h4 style="color:var(--primary);">ğŸŒ± Teil E: Nachhaltigkeit</h4>
    <p><strong>11a)</strong> Thermoplast (weich+formbar), Duroplast (zersetzt sich), Elastomer (elastisch).</p>
    <p><strong>11b)</strong> Nur Thermoplaste â€“ wiederholtes Aufschmelzen mÃ¶glich.</p>
    <p><strong>11c)</strong> Downcycling = Recycling mit QualitÃ¤tsverlust.</p>
    <p><strong>12a)</strong> Verwechslung mit Nahrung, Mikroplastik in Nahrungskette, Verfangen in Plastik.</p>
    <p><strong>12b)</strong> Biobasiert â‰  biologisch abbaubar. Die chemische Struktur entscheidet.</p>
    <p><strong>12c)</strong> Mehrweg: weniger Rohstoff + Energie durch Mehrfachnutzung â†’ kleiner Ã¶kologischer FuÃŸabdruck.</p>
  `;
  area.scrollIntoView({ behavior: 'smooth' });
}
</script>

</body>
</html>
